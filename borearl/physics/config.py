from typing import Any, Dict
import numpy as np


def get_model_config() -> Dict[str, Any]:
    """
    Returns a dictionary with all model constants and configurable parameters.
    Extracted from the legacy `energy_balance_rc.get_model_config`.
    """
    config = dict(
        SIGMA=5.670374419e-8,
        RHO_AIR=1.225,
        CP_AIR=1005,
        RHO_WATER=1_000.0,
        RHO_SNOW=250.0,
        KAPPA=0.41,
        G_ACCEL=9.81,
        PSYCHROMETRIC_GAMMA=0.066,
        Lv=2.5e6,
        Lf=3.34e5,
        EPS=np.finfo(float).eps,
        TIME_STEP_MINUTES=120,
        C_CANOPY_LEAF_OFF=2.0e4,
        C_CANOPY_LEAF_ON=8.0e4,
        C_TRUNK=5.0e5,
        C_SNOW=1.0e5,
        C_ATM=1.2e5,
        C_SOIL_TOTAL=6.0e6,
        T_MIN=180.0,
        T_MAX=330.0,
        DT_CLIP=15.0,
        SWE_SMOOTHING=0.01,
        CANOPY_MIN_H=10.0,
        H_atm=100.0,
        tau_adv=3600.0,
        z_ref_h=15.0,
        z0_can_range=(1.0, 2.0),
        z_ref_soil=2.0,
        z0_soil_range=(0.005, 0.02),
        h_trunk_const=5.0,
        h_trunk_wind_coeff=4.0,
        u_ref_range=(1.0, 5.0),
        d_soil_surf=0.3,
        d_soil_deep=1.7,
        k_soil_range=(0.8, 1.6),
        SWC_max_mm_range=(100.0, 200.0),
        soil_stress_threshold_range=(0.3, 0.6),
        T_deep_boundary_range=(268.0, 272.0),
        k_ext_factor_range=(0.5, 0.7),
        k_snow_factor_range=(0.75, 0.85),
        eps_can=0.98,
        eps_snow=0.98,
        eps_soil=0.95,
        eps_trunk=0.95,
        eps_atm_max=0.9,
        eps_atm_min_T=265.0,
        eps_atm_sensitivity=15.0,
        eps_atm_coeff_a=0.80,
        eps_atm_coeff_b=0.15,
        alpha_snow=0.80,
        alpha_soil=0.20,
        alpha_trunk=0.25,
        latitude_deg_range=(56.0, 65.0),
        T_annual_mean_offset_range=(-10.0, -5.0),
        T_seasonal_amplitude_range=(20.0, 25.0),
        T_diurnal_amplitude_range=(4.0, 8.0),
        T_hour_peak_diurnal_range=(3.0, 5.0),
        mean_relative_humidity_range=(0.6, 0.8),
        rain_summer_prob_range=(0.10, 0.20),
        rain_summer_mm_day_range=(10.0, 20.0),
        rain_shoulder_prob_range=(0.05, 0.15),
        rain_shoulder_mm_day_range=(5.0, 15.0),
        snow_winter_prob_range=(0.15, 0.30),
        winter_snow_mm_day_range=(3.0, 8.0),
        temp_precip_summer_sensitivity_range=(0.05, 0.09),
        temp_precip_shoulder_sensitivity_range=(0.03, 0.07),
        temp_precip_winter_sensitivity_range=(0.08, 0.12),
        temp_precip_summer_base_temp_range=(12.0, 18.0),
        temp_precip_shoulder_base_temp_range=(5.0, 12.0),
        rain_diurnal_sensitivity_range=(0.10, 0.20),
        rain_diurnal_threshold_range=(0.5, 2.0),
        max_diurnal_reduction_range=(0.4, 0.7),
        min_diurnal_amplitude_range=(0.8, 1.5),
        summer_day_start_range=(140, 160),
        summer_day_end_range=(240, 260),
        shoulder_1_start_range=(80, 100),
        shoulder_1_end_range=(140, 160),
        shoulder_2_start_range=(240, 260),
        shoulder_2_end_range=(290, 310),
        snow_season_end_range=(110, 130),
        snow_season_start_range=(270, 290),
        T_daily_noise_std_range=(1.0, 2.0),
        growth_day_range=(130, 150),
        fall_day_range=(260, 280),
        growth_rate_range=(0.08, 0.15),
        fall_rate_range=(0.08, 0.15),
        woody_area_index_range=(0.3, 0.4),
        A_trunk_plan=0.03,
        A_trunk_vert=0.08,
        k_ct_base_con=0.18,
        k_ct_base_dec=0.12,
        d_ct=0.1,
        A_c2t=0.08,
        k_tsn=0.05,
        d_tsn=0.1,
        k_tso=0.8,
        d_tso=0.1,
        k_snow_pack=0.3,
        PT_ALPHA=1.26,
        PAR_FRACTION=0.5,
        LUE_J_TO_G_C=1e-6,
        GPP_SCALING_BIOMASS_THRESHOLD_kg_m2=12.0,
        R_BASE_KG_M2_YR_range=(0.30, 0.4),
        R_BASE_SOIL_KG_M2_YR_range=(0.4, 0.6),
        RESPIRATION_BIOMASS_SIZE_SCALAR_kg_m2=10.0,
        RESPIRATION_SOIL_SIZE_SCALAR_kg_m2=10.0,
        Q10_range=(1.8, 2.3),
        T_REF_K=288.15,
        LITTERFALL_FRACTION_range=(0.03, 0.04),
        LITTERFALL_SEASONALITY_range=(0.6, 0.9),
        NATURAL_MORTALITY_RATE_range=(0.02, 0.03),
        NATURAL_RECRUITMENT_RATE_range=(0.005, 0.015),
        MAX_NATURAL_DENSITY_range=(1500, 2000),
        DENSITY_DEPENDENT_MORTALITY_range=(0.03, 0.04),
        DENSITY_MORTALITY_THRESHOLD_range=(0.7, 0.9),
        FIRE_DROUGHT_THRESHOLD_range=(20, 40),
        FIRE_TEMP_THRESHOLD_K=293.15,
        FIRE_BASE_PROB_range=(0.0001, 0.0005),
        FIRE_CONIFER_FLAMMABILITY_factor=2.5,
        FIRE_MORTALITY_MAX_RATE=0.1,
        FIRE_CARBON_COMBUSTED_frac=0.85,
        MAX_BIOMASS_CARBON_LIMIT_kg_m2=15.0,
        MAX_SOIL_CARBON_LIMIT_kg_m2=20.0,
        FIRE_INTENSITY_MAX_BIOMASS_kg_m2=15.0,
        FIRE_INTENSITY_MIN_FACTOR=0.1,
        FIRE_INTENSITY_MAX_FACTOR=1.0,
        INSECT_WARM_WINTER_THRESHOLD_C=-25.0,
        INSECT_DENSITY_THRESHOLD_ha=600,
        INSECT_BASE_PROB_range=(0.02, 0.05),
        INSECT_CONIFER_SUSCEPTIBILITY=0.9,
        INSECT_MORTALITY_RATE_range=(0.02, 0.05),
        MAX_DENSITY_FOR_FULL_CANOPY=1500.0,
        LAI_max_conifer_range=(3.0, 5.0),
        LAI_max_deciduous_range=(4.0, 6.0),
        alpha_can_base_conifer_range=(0.07, 0.11),
        alpha_can_base_deciduous_range=(0.15, 0.20),
    )

    config["J_PER_GC"] = 0.1 / config["LUE_J_TO_G_C"]
    return config


